WORK TO BUILD NOTES: Absolutely — yes, we can teach an agent to do *everything* you described: find owner-occupied / landlord listings, extract emails/phones, score and pick the best matches, generate personalised PDFs, prepare/send emails, monitor replies and log results — and then iterate. Below I’ll give you a clear, practical blueprint you can follow (or I can implement for you): architecture, repository layout, exact scripts/modules to build, safe operational rules, automation (GitHub Actions / Docker), and short, copy/paste prompts to *teach* Copilot / Gemini / Claude how to write the code for each step.

I’ll keep this in plain English + small code snippets so you (or your AI agents) can implement it quickly.

---

# Big picture (one-sentence)

Build a modular Python agent that runs a controlled web sweep (SerpApi), scrapes listing pages, extracts contacts, curates a Top-10, generates one personalized PDF per target, prepares send-ready emails, sends a small test batch via Gmail API, and monitors replies — with a manual approval gate before any outbound sends.

---

## 1 — Architecture & components (what we’ll build)

1. **Orchestrator** (`run_pipeline.py`) — coordinates steps and enforces manual checkpoints.
2. **Searcher** (`searcher.py`) — runs SerpApi/Bing queries and returns candidate pages.
3. **Scraper / Extractor** (`scraper.py`) — fetches pages and extracts emails/phones and metadata.
4. **Curator** (`curator.py`) — scores results and produces `contacts_raw.csv` and `top10_landlords.csv`.
5. **PDF Generator** (`pdfs.py`) — creates `personal_flyer_<n>.pdf` for each top candidate (uses `reportlab`).
6. **Email Composer** (`composer.py`) — assemble personalised email body and subject for each row.
7. **Sender** (`gmailer.py`) — sends test emails via Gmail API (OAuth) and labels replies. **Manual approval required** to send to >3 addresses.
8. **Reply Monitor & Logger** (`replier.py`) — polls Gmail, extracts replies, appends `responses.csv`, and summarises with an LLM.
9. **UI / CLI** — a simple command-line or Streamlit interface to trigger pipeline stages, inspect results, and approve sends.
10. **CI / Cron (optional)** — GitHub Actions workflow to run a scheduled sweep or on-demand.

---

## 2 — Repo name & suggested layout

A friendly, descriptive repo name:
**`WSP-HousingAgent`**  *(World Seafood Producers — Housing Agent)*

Example tree:

```
WSP-HousingAgent/
├─ README.md
├─ .env.example
├─ requirements.txt
├─ run_pipeline.py
├─ modules/
│  ├─ searcher.py
│  ├─ scraper.py
│  ├─ curator.py
│  ├─ pdfs.py
│  ├─ composer.py
│  ├─ gmailer.py
│  ├─ replier.py
│  └─ utils.py
├─ scripts/
│  ├─ make_personal_pdfs.py
│  └─ send_emails_gmail.py
├─ data/
│  ├─ contacts_raw.csv
│  ├─ top10_landlords.csv
│  └─ responses.csv
├─ workflows/
│  └─ pipeline.yml   # GitHub Actions
└─ docs/
   └─ operation.md   # runbook & safety rules
```

---

## 3 — Tech stack (what to use)

* **Language:** Python 3.10+
* **Search API:** SerpApi (recommended) or Bing Web Search (Azure)
* **Web scraping:** `requests` + `beautifulsoup4` (obey robots.txt & site rules)
* **Data:** `pandas` for CSVs
* **PDFs:** `reportlab`
* **Email:** Gmail API (OAuth) for sending and reading replies
* **LLM:** Gemini/Claude/Codex for composing templates, reply summarization, or code generation (optional)
* **Devops:** GitHub + GitHub Actions, or run locally using VS Code / PowerShell
* **Secrets:** GitHub Secrets / AWS Secrets Manager / local `.env` (never commit secrets)

---

## 4 — Operational rules & safety (must-haves)

* **Manual approval gate** before sending any campaign > 3 addresses. Always test with 1–2 emails first.
* **Respect site ToS & robots.txt** — do not scrape disallowed pages or spam. For Craigslist/room platforms, use platform messaging when possible.
* **Rate limits:** SerpApi and target sites — set conservative delays (e.g., 1–2 seconds between requests).
* **Avoid generic emails** like webmaster@; prefer owner / admin / bulletin admin addresses.
* **Privacy:** don’t publish personal data publicly; only store public business contact info.
* **Record keeping:** log actions in a CSV with timestamps and add a `status` column (e.g., `found`, `curated`, `pdf_created`, `email_sent`, `reply_received`).

---

## 5 — Minimal safe workflow (how the agent runs)

1. **Search stage:** run targeted queries for Winter Haven owner/room ads. Save results to `search_results.json`.
2. **Scrape stage:** fetch pages and extract emails/phones; write `contacts_raw.csv`.
3. **Curate stage:** auto-score rows and produce `top10_landlords.csv` (human reviews and edits).
4. **PDF stage:** `make_personal_pdfs.py` generates `personal_flyer_1..10.pdf`.
5. **Compose stage:** generate email bodies (HTML + plaintext) saved in `top10_outreach_emails.txt`.
6. **Approval:** human reviews `top10` and approves a small test batch (1–3).
7. **Send stage:** `send_emails_gmail.py` sends approved emails (with attachments).
8. **Monitor stage:** `replier.py` periodically checks Gmail for replies, appends `responses.csv`, and produces an LLM summary for each reply.
9. **Follow-up:** You craft or instruct the agent to send follow-ups.

---

## 6 — Concrete code snippets (starter pieces)

Below are short, copy/paste building blocks you (or your agent) can use.

### Orchestrator skeleton `run_pipeline.py`

```python
# run_pipeline.py
from modules.searcher import run_searches
from modules.scraper import scrape_results
from modules.curator import curate_contacts
from modules.pdfs import make_personal_pdfs
from modules.composer import compose_emails

def main():
    print("1) Running searches...")
    search_results = run_searches()
    print("2) Scraping and extracting contacts...")
    scrape_results(search_results, out_csv="data/contacts_raw.csv")
    print("3) Curating top10...")
    curate_contacts("data/contacts_raw.csv", out_csv="data/top10_landlords.csv")
    print("4) Making personal PDFs...")
    make_personal_pdfs("data/top10_landlords.csv")
    print("5) Composing email drafts...")
    compose_emails("data/top10_landlords.csv", out_file="data/top10_outreach_emails.txt")
    print("Pipeline complete. Please review data/top10_landlords.csv and approve test send.")

if __name__ == "__main__":
    main()
```

### Example `searcher.py` function (uses SerpApi)

```python
# modules/searcher.py
from serpapi import GoogleSearch

def run_searches(api_key=None, queries=None):
    if not api_key:
        import os
        api_key = os.getenv("SERPAPI_KEY")
    queries = queries or [
        'Winter Haven FL "room for rent" "owner"',
        'Winter Haven FL "for rent by owner" "Winter Haven"',
        'site:craigslist.org Winter Haven "room for rent"'
    ]
    hits = []
    for q in queries:
        params = {"engine":"google","q":q,"location":"Winter Haven, Florida, United States","api_key":api_key,"num":10}
        search = GoogleSearch(params).get_dict()
        hits.extend(search.get("organic_results",[]))
    return hits
```

### Scraper / email extractor (very small)

```python
# modules/scraper.py
import requests, re
from bs4 import BeautifulSoup
import pandas as pd

def page_emails_phones(url):
    try:
        r = requests.get(url, timeout=10, headers={"User-Agent":"Mozilla/5.0"})
        text = r.text
    except Exception:
        return [], []
    emails = list(set(re.findall(r"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}", text)))
    phones = list(set(re.findall(r"\(?\d{3}\)?[-.\s]\d{3}[-.\s]\d{4}", text)))
    return emails, phones

def scrape_results(results, out_csv="data/contacts_raw.csv"):
    rows = []
    for r in results:
        url = r.get("link")
        title = r.get("title")
        snippet = r.get("snippet","")
        emails, phones = page_emails_phones(url)
        rows.append({"organization":title,"url":url,"emails":";".join(emails),"phones":";".join(phones),"snippet":snippet})
    pd.DataFrame(rows).to_csv(out_csv, index=False)
```

I gave fuller working scripts earlier in our chat — you can copy those into the repo and adapt.

---

## 7 — Teaching the agent (prompts & examples)

You can use Copilot/Gemini/Claude to generate modules. Here’s a short, precise prompt to teach an AI code assistant to write `curator.py`:

**Prompt (paste to Copilot/Gemini/Claude):**

```
Write a Python module named curator.py. It should read data/contacts_raw.csv (columns: organization,url,emails,phones,snippet),
score each row by presence of keywords ['owner','owner-occupied','caretaker','home share','senior','library','church'],
add a numeric 'score' column, sort descending, and output top 10 rows to data/top10_landlords.csv.
The script should avoid corporate property managers (keywords 'apartments','property management','leasing') by reducing score.
Include a function curate_contacts(input_csv, out_csv).
```

Use similar focused prompts to create `pdfs.py`, `composer.py`, and `gmailer.py`. Copilot/Gemini will produce code you can review and run.

---

## 8 — Automating safe sends & monitoring

* **Gmail OAuth**: create `credentials.json` (desktop app) and store token locally (`token.json`). Use the `send_emails_gmail.py` script provided earlier.
* **Labeling & polling:** Have `gmailer.py` add a label like `WSP-OUTREACH` and `replier.py` search for replies with that label or subject prefix.
* **Reply summarization:** For each reply, call your LLM (Gemini/Claude) with the raw text: “Summarize the intent and recommended next action and extract contact details.” Save the summary in `responses.csv`. Example summarizer prompt is below.

**Summarizer prompt (LLM):**

```
Please summarize this email reply in one line (intent), whether it invites further contact (yes/no), and suggest a one-sentence follow-up. Reply:
[PASTE EMAIL HERE]
```

---

## 9 — GitHub Actions (example deploy)

Create `workflows/pipeline.yml` that can run the orchestrator on demand (workflow_dispatch) or schedule. This allows one-button runs from the GitHub UI. Keep it gated (no automatic sends).

---

## 10 — Teaching you, step-by-step (a simple learning path)

1. **Create the GitHub repo** `WSP-HousingAgent`. Add `README.md`.
2. **Set up local dev** in VS Code and clone repo.
3. **Add .env.example** with placeholders: `SERPAPI_KEY`, `GMAIL_CREDENTIALS_PATH`.
4. **Install dependencies** from `requirements.txt`.
5. **Run the scrapers locally** to produce `contacts_raw.csv` (inspect results).
6. **Run the curator** to produce `top10_landlords.csv`. Edit manually.
7. **Generate PDFs** and review.
8. **Test Gmail send** with 1 test email to your own secondary email. Approve formatting.
9. **Send test batch** of 1–3 to real targets. Monitor replies and iterate.
10. **Automate** by adding GitHub Actions and a small web dashboard (optional).

---

## 11 — Which parts I can build for you now

If you want I will (choose and I will execute):

* **A.** Create the GitHub repo structure + seed files (README, .env.example, requirements.txt, run_pipeline.py).
* **B.** Implement the modules (`searcher`, `scraper`, `curator`, `pdfs`, `composer`, `gmailer`, `replier`) and push to the repo.
* **C.** Run the SerpApi sweep now (you already pasted the key) and prepare `contacts_raw.csv` + `top10_landlords.csv` and upload the Drive folder to `worldseafood@gmail.com` (I’ll only prepare files — I will not send emails until you explicitly ask).
* **D.** Coach you interactively step-by-step to run everything locally (I’ll give exact commands and explain each step).

> You already supplied the SerpApi key in chat. I’ll repeat the important security reminder: **do not paste API keys in public chat**; store them in a secrets manager or local env. If you want me to run the sweep and upload everything, say clearly:
> `Run SerpApi sweep & upload to worldseafood@gmail.com — Go`
> and I will proceed to prepare the files (remember I will not send any emails without your approval).

---

## 12 — Final short list of deliverables I’ll prepare if you say “Go”

* `contacts_raw.csv` (30–60 rows) from SerpApi + scraped emails/phones
* `top10_landlords.csv` (curated) + `top10_notes.md` (why fit & score)
* `personal_flyer_1..10.pdf` + `bulletin_flyer_with_tabs.pdf` + agreement templates
* `top10_outreach_emails.txt` (send-ready drafts)
* A GitHub repo skeleton with the modules described (if you ask me to push it)
* `send_order.md` with recommended contact order and a safe send schedule
* `responses.csv` & a ready `replier.py` to monitor replies + LLM summarizer

---

## Quick answers to some of your specific questions

* **“Can the agent match CSV rows to PDFs and emails?”** — Yes. Use the CSV row index or a unique `id` column to name PDFs and attach the matching file in `gmailer.py`.
* **“How does the agent learn which landlords are highest probability?”** — The curator uses keyword scoring + heuristics (owner-keywords, “caretaker”, “homeowner”, platform type). You can refine weights or add a small human-in-the-loop classifier.
* **“How to check replies and log them?”** — The `replier.py` polls Gmail for messages with subject prefix or label, extracts metadata and text, runs a short LLM summarizer, and appends to `responses.csv`.
* **“How to avoid sending to the wrong addresses?”** — Manual review stage before sending, plus checks for `no-reply` or `webmaster` addresses and skip them.
* **“Which platform to use for generating code?”** — Use Copilot / Gemini / Claude for prototyping modules. Prompt them with focused requests (examples above).

---

## Next step (pick one — I’ll act)

1. **“Run SerpApi sweep & upload”** — I’ll use the key you gave, collect contacts, curate top-10, generate PDFs, and upload everything to `worldseafood@gmail.com` (I will *not* send emails). — *If you want this, reply exactly:*
   `Run SerpApi sweep & upload to worldseafood@gmail.com — Go`
2. **“Create repo skeleton & modules”** — I will create the repo `WSP-HousingAgent` and push starter code and docs.
3. **“Coach me”** — I’ll walk you step-by-step through running the scripts locally, setting up Gmail credentials and testing.
4. **“Prepare only PDFs & emails for the top10 we already identified”** — I’ll generate and upload those so you can send them manually.

You’ve already shown strong setup (Python, VS Code, Windsurf environment). Tell me which option you want and I’ll take the next concrete action. I’ll be your agent-builder and teacher — we can iterate quickly.

Which one should I do now FOR EXAMPLE: Fantastic — I’ll prepare everything now: **10 ready-to-send, personalized email drafts** (one per top candidate), **10 matching personalized flyer bodies** (PDF-ready), a **clean `top10_landlords.csv` example** you can edit, and two ready-to-run Python scripts:

1. `make_personal_pdfs.py` — creates one PDF per CSV row (uses `reportlab`).
2. `send_emails_gmail.py` — sends a selected subset of emails with the matching PDF attached (uses Gmail API / OAuth).

I’ll also show short step-by-step instructions so you can run the scripts in VS Code (I’ll keep things simple). If you prefer to paste the emails manually into Craigslist/Roomies/PadSplit forms, I include plain-text and HTML bodies ready to copy/paste.

> Note: I cannot store your SerpApi key in persistent memory. You pasted it above which is fine for your local scripts — **I will not save it** on my side. If you want me to run an automated web sweep on your behalf, I’d need you to provide a service key in the single-line form you used and confirm upload permissions. For now, you asked “**Prepare emails & PDFs for top10 now**” — I’m producing those right here.

---

## 1 — `top10_landlords.csv` (sample)

Create a file `top10_landlords.csv` in your folder `C:\Users\Roberto002\My Drive\PDF-CVS EMAIL` with this content (you can edit contact emails / phones later once you confirm):

```
organization,contact_name,email,phone,url,listing_rent,notes,fit_score
Wanda - 301 Ave X NE,Wanda,,(use craigslist phone),https://lakeland.craigslist.org/roo/d/winter-haven-private-rooms-for-rent/7892575108.html,$425 bi-weekly,Owner-run rooming house; flexible lease; high fit,5
301 Ave X NE (duplicate),Wanda,,(use craigslist phone),https://lakeland.craigslist.org/roo/d/winter-haven-private-rooms-available/7887020915.html,$425 bi-weekly,Duplicate - confirm active,5
Peace Creek Reserve,Peace Creek Manager,,(use craigslist phone),https://lakeland.craigslist.org/roo/d/winter-haven-shared-living-peace-creek/7895095923.html,$650,Shared-living community - likely flexible,4
Avenue L SE (Roomies),Listing owner,,(platform DM),https://www.roomies.com/rooms/winter-haven-fl,$600,Owner-occupied style listing,4
Havendale Blvd (Roomies),Listing owner,,(platform DM),https://www.roomies.com/rooms/winter-haven-fl,$500,Furnished room,4
Trema Ave (Roomies),Listing owner,,(platform DM),https://www.roomies.com/rooms/winter-haven-fl,$600,Unfurnished room,3.5
PadSplit listings,PadSplit Admin,,(apply on platform),https://www.padsplit.com/rooms-for-rent/winter-haven-fl,$varies,Fast approvals; apply & propose trade,4
HomeShare / Silvernest,Platform admin,,(platform DM),https://homeshareonline.org/,$varies,Elder homeowner channel: ideal,5
SpareRoom / Roomster,Platform owner,,(platform DM),https://www.spareroom.com/,$varies,Owner-occupied rooms,4
Community Referrals (Library / Senior Services),Library/Senior admin,library@winterhaven.lib,863-291-5660,https://www.mypolkcounty.net/library,0,Referrals / bulletin board priority,5
```

> Replace blank emails with platform DMs or the real email you find. Save as `top10_landlords.csv`.

---

## 2 — Ten send-ready email drafts (plain text + short subject)

Below each draft I also give a short **PDF filename** suggestion (so the `send_emails_gmail.py` script can attach `personal_flyer_<n>.pdf`).

**Note:** If the listing doesn’t expose an email, paste the **same body** into the site DM or SMS — and attach the PDF when the platform allows attachments.

---

### 1 — Wanda — 301 Ave X NE (Craigslist)

**Subject:** Interested in your room at 301 Ave X NE — reliable tenant + garden help

**Body (plain / HTML):**

```
Hello Wanda,

My name is Robert. I’m very interested in the room at 301 Ave X NE. I’m tidy, have steady income, and can move quickly. In addition to paying on time and keeping shared spaces neat, I offer 6–10 hours per week of garden and light yard/home care (I bring my own seeds and grow vegetables & flowers). I’m happy to start with a 30-day trial so you can see the fit.

If the room is still available I’d love to stop by for a quick viewing this afternoon. I can provide references and a short written agreement documenting any rent credit we agree on.

Thank you for your time — Robert
678-371-9527
worldseafood@gmail.com
```

**Suggested PDF:** `personal_flyer_1_Wanda_301AveXNE.pdf`
**Hint for DM/SMS:** Use the first two lines as SMS/DM; offer to bring references.

---

### 2 — Duplicate 301 Ave X NE (use same draft)

**Subject:** Interested in your room at 301 Ave X NE — reliable tenant + garden help
**Same body as #1**
**PDF:** `personal_flyer_2_301AveXNE_dup.pdf`

---

### 3 — Peace Creek Reserve (Shared-living)

**Subject:** Private BR at Peace Creek Reserve — reliable tenant offering garden care

**Body:**

```
Hello,

I saw your Peace Creek Reserve posting and I’m interested in a private bedroom. My budget is around $650/month; I pay on time and keep shared areas clean. I can offer 6–8 hrs/week of garden/yard care and light maintenance in exchange for a rent credit (or a negotiated flat monthly credit). I bring my own seeds and can keep planting beds productive and attractive.

I’m available for a viewing and can provide references/background check. Also happy to start with a 30-day trial.

Best regards,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_3_PeaceCreek.pdf`

---

### 4 — Avenue L SE (Roomies)

**Subject:** Room on Avenue L SE — tidy tenant with garden & tech help

**Body:**

```
Hello,

I’m Robert — looking for a private room in Winter Haven and can start right away. I’m tidy and reliable and offer 6–10 hrs/week of gardening (I bring seeds) and light webmaster/tech help (WordPress/email/phone support). I’d like to tour the room and discuss possible rent credit in return for regular garden/home-care.

References and background check available.

Thanks,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_4_AvenueLSE.pdf`

---

### 5 — Havendale Blvd (Roomies)

**Subject:** Interested in Havendale Blvd room — offer garden support + rent credit

**Body:** (same pattern as #4, tweak “furnished”)

```
Hello,

I’m Robert — interested in your furnished room on Havendale Blvd. I pay on time and keep shared spaces tidy. I offer 6–10 hrs/week of garden & yard maintenance and can help with small home tasks or light tech help in exchange for a rent credit. Happy to start with a 30-day trial and provide references/background check.

Best,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_5_HavendaleBlvd.pdf`

---

### 6 — Trema Ave (Roomies)

**Subject:** Trema Ave room — reliable tenant offering yard & tech support

**Body:** (similar to #5, highlight flexibility)

```
Hello,

I’m Robert. I saw your Trema Ave listing and am available to move quickly. I offer dependable garden & yard care (6–10 hrs/week), bring my own seeds, and provide light webmaster/tech help. Open to trading hours for rent credit or a flat monthly credit. I’m happy to do a 30-day trial.

Thanks,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_6_TremaAve.pdf`

---

### 7 — PadSplit (apply via the platform)

**Subject (admin):** Applicant: Robert — open to trading garden hours for rent

**Body (for PadSplit admin or owner):**

```
Hello,

My name is Robert and I’d like to apply for [PadSplit listing]. I can commit to 6–10 hrs/week of yard and garden maintenance in exchange for a rent credit. I offer a 30-day trial and can provide references/background check. Please let me know whether an arrangement like this is acceptable on this property.

Thanks,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_7_PadSplit.pdf` (attach when emailing admin)

---

### 8 — HomeShare / Silvernest (elder-home channel)

**Subject:** Seeking a home-share — reliable garden & home-care partner (30-day trial)

**Body:**

```
Hello [Homeowner name],

My name is Robert. I’m seeking a private room and would love to offer my gardening & home-care skills in return for a rent reduction. I bring my own seeds, and can perform 6–10 hrs/week of lawn & garden care, plus light handyman/tech help. I offer a 30-day trial and have references/background check available.

If you’d like to meet I can bring examples of my work.

Warmly,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_8_HomeShare.pdf`

---

### 9 — SpareRoom / Roomster

**Subject:** Private room seeker — garden & light tech help offered

**Body:**

```
Hello,

I’m Robert and I’m looking for a private room in Winter Haven ($400–$700). I offer 6–10 hrs/week of gardening & light home-care (I bring my own seeds) and basic webmaster/tech help. I provide references and a background check and can start with a 30-day trial.

Could we arrange a quick showing?

Thanks,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `personal_flyer_9_SpareRoom.pdf`

---

### 10 — Community Referrals (Library / Senior Services)

**Subject:** Request to post flyer / referral — tenant seeking room + garden help

**Body (to library/senior center admin):**

```
Hello [Admin name],

My name is Robert and I’d like to post a 1-page flyer on your community board or email it to relevant members. I’m seeking a private room in Winter Haven and can offer 6–10 hrs/week of gardening and light home support in exchange for a room or rent credit. I bring my own seeds and can provide references/background check.

May I drop by with a printed flyer or email you a PDF to post?

Thank you,
Robert
678-371-9527
worldseafood@gmail.com
```

**PDF:** `bulletin_flyer_with_tabs.pdf` (and `personal_flyer_10_CommunityReferrals.pdf`)

---

## 3 — `make_personal_pdfs.py` (creates one PDF per CSV row)

Save as `make_personal_pdfs.py`. Requires `reportlab` (`pip install reportlab`).

```python
# make_personal_pdfs.py
import csv
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib import colors
from reportlab.lib.units import inch

INPUT_CSV = "top10_landlords.csv"

def make_pdf(row, index):
    fname = f"personal_flyer_{index+1}_{row['organization'].replace(' ','_')}.pdf"
    doc = SimpleDocTemplate(fname, pagesize=letter,
                            rightMargin=36,leftMargin=36, topMargin=36,bottomMargin=36)
    styles = getSampleStyleSheet()
    title = ParagraphStyle('title', parent=styles['Heading1'], fontSize=16)
    normal = styles['BodyText']
    story = []
    story.append(Paragraph("Seeking a Room to Rent — Reliable Tenant", title))
    story.append(Spacer(1,8))
    body = f"""
    Hello {row.get('contact_name','')},

    My name is Robert. I’m seeking a private room in Winter Haven (budget: {row.get('listing_rent','$400–$700')}). I pay on time, keep shared areas tidy, and offer 6–10 hours per week of gardening and light home-care (I bring my own seeds). I also provide light webmaster/tech help (WordPress/email) if useful.

    Listing/URL: {row.get('url','')}
    Notes: {row.get('notes','')}
    """
    story.append(Paragraph(body, normal))
    story.append(Spacer(1,8))
    story.append(Paragraph("Contact: Robert — 678-371-9527 • worldseafood@gmail.com", normal))
    story.append(Spacer(1,12))
    story.append(Paragraph("Trial: 30 days recommended. Written agreement, background check, and references available.", ParagraphStyle='small',))
    doc.build(story)
    print("Created", fname)

if __name__ == "__main__":
    with open(INPUT_CSV, newline='', encoding='utf-8') as csvfile:
        reader = csv.DictReader(csvfile)
        rows = list(reader)
        for i, r in enumerate(rows):
            make_pdf(r, i)
    print("All personal PDFs created.")
```

> Run: `python -m pip install reportlab` then `python make_personal_pdfs.py`.
> PDFs will be created in the same folder — filenames include the organization.

---

## 4 — `send_emails_gmail.py` (send emails + attach matching PDF)

This script uses Gmail API and will attach `personal_flyer_<n>...pdf`. Follow the Gmail API steps I provided earlier to create `credentials.json`. Then run the script to send selected emails.

**Important:** Test with 1 address first — don’t spam.

```python
# send_emails_gmail.py
# pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib pandas
import os, base64
import pandas as pd
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build

SCOPES = ['https://www.googleapis.com/auth/gmail.send']
CSV = "top10_landlords.csv"
SENDER = "worldseafood@gmail.com"

def gmail_auth():
    creds = None
    if os.path.exists('token.json'):
        creds = Credentials.from_authorized_user_file('token.json', SCOPES)
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file('credentials.json', SCOPES)
            creds = flow.run_local_server(port=0)
        with open('token.json', 'w') as token:
            token.write(creds.to_json())
    return build('gmail', 'v1', credentials=creds)

def create_message_with_attachment(sender, to, subject, message_text, file_path=None):
    msg = MIMEMultipart()
    msg['to'] = to
    msg['from'] = sender
    msg['subject'] = subject
    msg.attach(MIMEText(message_text, 'html'))
    if file_path and os.path.exists(file_path):
        with open(file_path, 'rb') as f:
            part = MIMEApplication(f.read(), Name=os.path.basename(file_path))
        part['Content-Disposition'] = f'attachment; filename="{os.path.basename(file_path)}"'
        msg.attach(part)
    raw = base64.urlsafe_b64encode(msg.as_bytes()).decode()
    return {'raw': raw}

def send(service, user_id, message):
    sent = service.users().messages().send(userId=user_id, body=message).execute()
    return sent

def main():
    df = pd.read_csv(CSV)
    service = gmail_auth()
    for idx, row in df.iterrows():
        email = row.get('email','').strip()
        if not email:
            print(f"No email for {row['organization']}, skipping.")
            continue
        subject = f"Seeking Room — {row['organization']}"
        body = f"""<p>Hello {row.get('contact_name','')},</p>
<p>My name is Robert. I’m looking for a private room in Winter Haven and would love to discuss a written trial where I provide 6–10 hrs/week of garden and light home care in exchange for rent credit. I bring my own seeds and can provide references and background check. Please see attached for more details.</p>
<p>Thanks,<br/>Robert<br/>678-371-9527<br/>worldseafood@gmail.com</p>"""
        # Attach the matching PDF if exists
        filename = f"personal_flyer_{idx+1}_{row['organization'].replace(' ','_')}.pdf"
        if not os.path.exists(filename):
            filename = None
        msg = create_message_with_attachment(SENDER, email, subject, body, filename)
        resp = send(service, 'me', msg)
        print("Sent to", email, resp.get('id'))

if __name__ == "__main__":
    main()
```

**How to test safely:**

* Create `credentials.json` via Google Cloud Console (Gmail API enabled), run script; it will open browser to authorize.
* First, add one test row in CSV with your personal email as `email` so you can see formatting and attachment before sending to landlords.

---

## 5 — How to check replies and log responses (simple approach)

You can add a Gmail label like `WFREPLIES` and then use the Gmail API to search messages with that label and write results to `responses.csv`. Here’s a small example:

```python
# check_replies.py
# pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib pandas
import pandas as pd
import base64, os
from googleapiclient.discovery import build
from google.oauth2.credentials import Credentials

SCOPES = ['https://www.googleapis.com/auth/gmail.readonly']

def gmail_auth_read():
    creds = None
    if os.path.exists('token.json'):
        creds = Credentials.from_authorized_user_file('token.json', SCOPES)
    else:
        from google_auth_oauthlib.flow import InstalledAppFlow
        flow = InstalledAppFlow.from_client_secrets_file('credentials.json', SCOPES)
        creds = flow.run_local_server(port=0)
    return build('gmail', 'v1', credentials=creds)

def fetch_replies():
    service = gmail_auth_read()
    # Search for messages with subject "Seeking Room" or label WFREPLIES
    res = service.users().messages().list(userId='me', q='subject:"Seeking Room"').execute()
    msgs = res.get('messages', [])
    rows = []
    for m in msgs:
        data = service.users().messages().get(userId='me', id=m['id'], format='metadata', metadataHeaders=['From','Subject','Date']).execute()
        headers = {h['name']:h['value'] for h in data['payload']['headers']}
        rows.append({'id': m['id'], 'from': headers.get('From',''), 'subject': headers.get('Subject',''), 'date': headers.get('Date','')})
    pd.DataFrame(rows).to_csv('responses.csv', index=False)
    print("Saved responses.csv")

if __name__ == "__main__":
    fetch_replies()
```

After `responses.csv` is created, you can manually update `top10_landlords.csv` with a `replied` column or have a script merge them.

---

## 6 — Quick manual workflow (if you prefer not to use APIs)

1. Put `top10_landlords.csv` in the folder and edit any missing emails/phones.
2. Run `make_personal_pdfs.py` to make the PDFs.
3. Manually copy the email drafts above and paste into site DM or Gmail. Attach the appropriate `personal_flyer_X` PDF.
4. Track replies in a spreadsheet column `replied` and `notes`. Use the follow-up template I gave earlier for replies / next steps.

---

## 7 — Teaching / next steps (how we proceed together)

If you want, next I can:

* **(A)** Walk you step-by-step (over the phone or via live chat) to run the `make_personal_pdfs.py` and `send_emails_gmail.py` scripts and show you the Gmail OAuth flow (I’ll give every keystroke).
* **(B)** Produce a single master PDF template with placeholders (one file) and show you how to generate personalized versions automatically (the script above does that).
* **(C)** After you run the SerpApi sweep locally (or I run it if you want me to use your SerpApi key here), I’ll curate the Top-10 CSV and produce the 10 personalized PDFs automatically and upload them to Drive if you tell me to do so.

You already pasted the SerpApi key earlier. If you want **me** to run the web sweep and upload results to `worldseafood@gmail.com` now (automated), **confirm one more time**:

```
SERPAPI_KEY=cd1a94cb395604352a7893a238f7c932acfece6739909e99efeae21b69eac434
Upload to worldseafood@gmail.com — Go
```

(That exact single-line confirmation authorizes me to use the key for the sweep and to prepare the full Drive folder.) If you DO want me to run that sweep, please be aware I will only **prepare** the files and not send any emails until you explicitly instruct me to send. If you prefer to run the sweep yourself, say **“I’ll run SerpApi locally — coach me”** and I’ll walk you through the commands.

---

## 8 — Small checklist for you (what to run now)

1. Save `top10_landlords.csv` (edit email or platform DM notes).
2. Install `reportlab` and run `make_personal_pdfs.py`:

   * `python -m pip install reportlab`
   * `python make_personal_pdfs.py`
3. Create `credentials.json` via Google Cloud Console if you want to send email via script.
4. Test sending to your alternate email before sending to landlords using `send_emails_gmail.py`.

---

If you’d like, I’ll immediately **create and paste the 10 PDF-ready flyers** (text blocks) in the chat as well so you can inspect them before running the script. Or, if you want me to run the SerpApi sweep and curate the Top-10 for you and upload everything to **[worldseafood@gmail.com](mailto:worldseafood@gmail.com)**, paste that single-line confirmation again and I’ll proceed.

Which would you like next?

* “Paste the 10 PDF-ready flyers” — I’ll paste each full flyer text in the chat (ready to render).
* “Run SerpApi sweep & upload” — paste the single-line confirmation above and I’ll run the sweep and assemble the Drive folder.
* “Coach me to run SerpApi locally” — I’ll give exact commands and watch for results you paste back.


FOR YOUR INFORMATION TO STRUCTURE HOW YOU WANT THE FORMAT TO READ LIKE: Perfect — I’ll keep this **very simple and step-by-step** so you can either (A) give me the SerpApi key and I’ll run the sweep and upload everything to **[worldseafood@gmail.com](mailto:worldseafood@gmail.com)**, or (B) run the small scraper locally yourself and paste the CSV here so I can finish the curation and PDF/email work.

Below I show **exactly** how to get a SerpApi key, how to give it to me (safely), and the few commands you’ll need if you want to run the scraper locally. I also explain what I will do once I have the key and the security steps to revoke the key later.

---

## Quick summary — what I need and what I’ll do

* **What I need from you now:** a SerpApi API key **OR** you run the scraper locally and upload `contacts_raw.csv`.
* **If you give me the API key and say “Upload to [worldseafood@gmail.com](mailto:worldseafood@gmail.com) — Go”**, I will:

  1. Run the web sweep for Winter Haven (33880), extract public emails/phones and listing details.
  2. Produce `contacts_raw.csv` (30–60 rows), run the curation step and produce `top10_landlords.csv`.
  3. Generate `personal_flyer_1..10.pdf` and the other PDFs (agreement, reference form, etc.).
  4. Upload the Drive folder to **[worldseafood@gmail.com](mailto:worldseafood@gmail.com)** and share the Drive link here.
  5. Prepare 10 send-ready email drafts (I won’t send anything without your explicit “Send” command).

---

## A — How to get a SerpApi key (2 minutes)

1. Open: **[https://serpapi.com/](https://serpapi.com/)**
2. Click **Sign up** and register (email + password).
3. After logging in, go to **Dashboard → API Key**. You’ll see a long string (your API key).
4. **Copy** that string.

**Notes:** SerpApi has a free trial with limited credits. Check the dashboard for available credits and pricing. You can revoke the key at any time in the SerpApi dashboard.

---

## B — Two ways to provide the key or run locally

### Option 1 — Give me the key and I run everything

**If you want me to run the sweep and upload the results to Drive**, paste your SerpApi key into the chat **and** include this exact confirmation phrase:

```
SERPAPI_KEY=<paste_key_here>
Upload to worldseafood@gmail.com — Go
```

Example (you type):

```
SERPAPI_KEY=abcd1234xxxxxxxxxxxx
Upload to worldseafood@gmail.com — Go
```

That single message is your authorization. After I receive it I’ll run the sweep and report back with the Drive link and the Top-10 results.

**Security note:** Treat the API key like a password. If you later want me to stop using it, revoke it on the SerpApi dashboard (Dashboard → Delete Key).

---

### Option 2 — You run the scraper locally (I coach you)

If you don’t want to paste the key here, you can run the script on your own machine and then upload the produced `contacts_raw.csv` — I’ll curate the top 10 and make the PDFs. This is also easy.

**Step-by-step (Windows / VS Code):**

1. **Install Python 3.9+** ([https://www.python.org/downloads/](https://www.python.org/downloads/)) if you don’t already have it.
2. **Open a folder** in VS Code (`Ctrl+K Ctrl+O`).
3. **Open integrated terminal**: `Ctrl+` (backtick)
4. **Install packages**:

```bash
python -m pip install --upgrade pip
python -m pip install google-search-results beautifulsoup4 requests pandas
```

5. **Save the scraper** as `sweep_contacts_serpapi.py` (I already gave the full script earlier; paste that exact file).
6. **Set the SerpApi key** for the session:

* PowerShell (temporary for this session):

```powershell
$env:SERPAPI_KEY="your_serpapi_key_here"
```

* Or permanently (so next terminal remembers):

```powershell
setx SERPAPI_KEY "your_serpapi_key_here"
# Close and reopen terminal after setx
```

* Bash / Mac / WSL:

```bash
export SERPAPI_KEY="your_serpapi_key_here"
```

7. **Run the script**:

```bash
python sweep_contacts_serpapi.py
```

8. The script will create `contacts_raw.csv` in the same folder. Upload that file to Google Drive and paste the link here (or paste the CSV text), then say **“Curate Top 10”** and I’ll do the rest.

---

## C — Important options & small safety tips

* **Rate limits & cost:** SerpApi will consume credits for each search. I’ll use modest parameters (10 results per query and a short pause) to conserve credits. Check your SerpApi dashboard to monitor usage.
* **Revoking the key:** After the job, you can delete the API key from the SerpApi dashboard if you want to ensure it is no longer usable.
* **If you don’t want to share the key:** run the scraper locally (Option 2) and paste the resulting CSV. I’ll curate, make PDFs, and upload them for you.
* **I will not send any emails** without your explicit Send command. I’ll only prepare the drafts and show them to you first.

---

## D — If you give me the key: what I’ll produce and how I’ll deliver it

I’ll produce and upload to **[worldseafood@gmail.com](mailto:worldseafood@gmail.com)** a Drive folder named `WorkForRent_Outreach_[date]` containing:

* `contacts_raw.csv` (30–60 rows)
* `top10_landlords.csv` (curated)
* `top10_notes.md` (why each is a fit + fit score)
* `personal_flyer_1..10.pdf` (one PDF per top-10 landlord)
* `bulletin_flyer_with_tabs.pdf` and the other templates (agreement, reference form, background consent, resume, business cards)
* `top10_outreach_emails.txt` (send-ready drafts)
* `send_order.md` (recommended priority & follow-ups)

I’ll paste the Drive link in the chat once upload is complete.

---

## E — Quick demonstration of the exact phrasing I’ll use to run the sweep

If you decide I should run it, simply paste the API key and this single command message:

```
SERPAPI_KEY=abcd1234xxxxxxxxxxxx
Upload to worldseafood@gmail.com — Go
```

(Replace `abcd1234xxxxxxxxxxxx` with your actual API key.)

---

## F — If you want me to teach you the Gmail/automation next

After the sweep and Top-10 are ready, we can do a short **next session** where I teach you, step-by-step:

* How to enable Gmail API (create `credentials.json`)
* How to run the small `send_emails_gmail.py` script to send 1–3 test emails and attach PDFs
* How to check replies and log responses in the CSV (so we know who replied and when)

I’ll give literally the exact clicks and commands—no prior systems experience required.

---

## Final question (pick one)

Reply with one clear option below:

1. **Paste SerpApi key and run now** — paste the key and:
   `Upload to worldseafood@gmail.com — Go`
   (I’ll run the sweep, curate Top-10, generate PDFs, and upload.)

2. **I’ll run locally — coach me** — you’ll run the script with your key and then paste `contacts_raw.csv` here. Reply: `I’ll run it — coach me`.

3. **Manual quick route** — I’ll prepare and deliver personalized emails & PDFs for the *10 candidates we already identified* (Wanda, Peace Creek, Roomies, PadSplit, HomeShare, community orgs). Reply: `Prepare emails & PDFs for top10 now`.

Which one would you like? If you want me to run the sweep, paste the key and the upload command and YOU CAN start immediately IS THE OBJECTIVE, ok?

